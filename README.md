
<a href="README.md">English</a> | <a href="README_fr.md">FranÃ§ais</a>


<function_calls>
<invoke name="computer">
<parameter name="action">file_create</parameter>
<parameter name="path">/home/claude/PredicateSearchApp/README_EN.md</parameter>
<parameter name="content"># PredicateSearchApp
SwiftUI application for macOS demonstrating the use of NSPredicateEditor with SwiftData.
ğŸ“‹ Description
This application allows you to create complex queries on a SwiftData database using the NSPredicateEditor graphical interface. The app automatically parses NSPredicate generated by the editor and converts them to SwiftData #Predicate when possible.
âœ¨ Features

Intuitive graphical interface: Use NSPredicateEditor to build complex queries without writing code
Automatic conversion: Parses NSPredicate to SwiftData #Predicate for optimal performance
Full operator support:

Comparison: ==, !=, <, >, <=, >=
Text: contains, beginsWith, endsWith (case sensitive/insensitive)
Logic: AND, OR, NOT
Booleans: true/false


Intelligent fallback: If conversion to #Predicate fails, manually filters results
Nested predicates: Support for complex queries with multiple condition levels
Real-time search: Instant result display

ğŸ—ï¸ Architecture
Data Model
swift@Model
final class EntityPerson {
    var id: UUID
    var firstName: String
    var lastName: String
    var dateOfBirth: Date
    var age: Int
    var department: String
    var country: String
    var isBool: Bool
}
Main Components

PredicateEditorWrapper: NSViewRepresentable wrapper to integrate NSPredicateEditor in SwiftUI
PredicateParser: Parses NSPredicate into usable structures
PredicateFactory: Generates SwiftData #Predicate from parsed rules
ModelContext Extension: Helper methods to execute searches

ğŸš€ Usage
Launching the Application

Open the project in Xcode
Build and run (âŒ˜R)
The app automatically loads sample data

Creating a Search

Click the "+" button to add a condition
Select the field (firstName, age, country, etc.)
Choose the operator (equals, contains, greater than, etc.)
Enter the search value
Add additional conditions with AND/OR
Click "Search" to see results

Search Examples
Find all people over 30 years old:

age > 30

Find people in France with first name starting with "A":

country == "France" AND firstName beginsWith "A"

Complex search:

(age >= 25 AND age <= 40) AND (country == "France" OR country == "Belgium")

Boolean search:

isBool == true AND department contains "IT"

ğŸ”§ Technical Features
Parsing NSPredicate â†’ #Predicate
The application intelligently parses NSPredicate:
swift// NSPredicate from NSPredicateEditor
let nsPredicate = NSPredicate(format: "age > 25 AND country == 'France'")

// Automatic parsing
let parsed = PredicateParser.parse(nsPredicate)

// Conversion to SwiftData #Predicate
let swiftPredicate = #Predicate<EntityPerson> { person in
    person.age > 25 && person.country == "France"
}
```

### #Predicate Limitations

Some functions are not supported by `#Predicate` and require manual filtering:

âŒ Not supported:
- `hasPrefix()` / `hasSuffix()` 
- Complex String functions

âœ… Supported:
- `==`, `!=`, `<`, `>`, `<=`, `>=`
- `contains()`
- `localizedStandardContains()`

### Search Strategy

1. **#Predicate attempt**: The app first tries to create a native #Predicate (more performant)
2. **Manual fallback**: If impossible, filters in memory with NSPredicate
3. **Guaranteed results**: You always get correct results

## ğŸ“Š Code Structure
```
PredicateSearchApp/
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ EntityPerson.swift           # SwiftData model
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ ContentView.swift            # Main view
â”‚   â”œâ”€â”€ PredicateEditorWrapper.swift # NSPredicateEditor wrapper
â”‚   â””â”€â”€ PersonListView.swift         # Results list
â”œâ”€â”€ Parser/
â”‚   â”œâ”€â”€ PredicateParser.swift        # Parse NSPredicate
â”‚   â”œâ”€â”€ PredicateFactory.swift       # Generate #Predicate
â”‚   â””â”€â”€ PredicateBuilder.swift       # Builder pattern
â”œâ”€â”€ Extensions/
â”‚   â””â”€â”€ ModelContext+Predicate.swift # Helper extensions
â””â”€â”€ App/
    â””â”€â”€ PredicateSearchApp.swift     # Entry point
ğŸ¯ Use Cases

Personnel management: Search employees by multiple criteria
Customer database: Advanced contact filtering
Data analysis: Complex queries on datasets
Administration tools: Search interface for administrators

ğŸ› ï¸ Technologies Used

SwiftUI: Modern user interface
SwiftData: Data persistence
AppKit: NSPredicateEditor for macOS
Combine: Reactive state management

âš™ï¸ Requirements

macOS 14.0+ (Sonoma)
Xcode 15.0+
Swift 5.9+

ğŸ“ Development Notes
Adding New Fields
To add a search field:

Add the property in EntityPerson
Create the template in PredicateEditorConfigurator
Add the case in PredicateField enum
Implement the logic in PredicateFactory

Customization
Modify PredicateEditorConfigurator.swift to:

Change available operators
Add/remove fields
Customize options (case sensitive, etc.)

ğŸ› Debugging
To see parsing details:
swiftif let parsed = PredicateParser.parse(predicate) {
    print(PredicateParser.debugDescription(parsed))
}
ğŸ¤ Contributing
Contributions are welcome! To contribute:

Fork the project
Create a feature branch (git checkout -b feature/AmazingFeature)
Commit your changes (git commit -m 'Add AmazingFeature')
Push to the branch (git push origin feature/AmazingFeature)
Open a Pull Request

ğŸ“„ License
This project is licensed under the MIT License. See the LICENSE file for details.
ğŸ™ Acknowledgments

Apple for SwiftData and NSPredicateEditor
The Swift community for best practices
All project contributors

ğŸ“§ Contact
For any questions or suggestions, feel free to open an issue on GitHub.

Note: This application is a demonstration example. For production use, add more robust error handling, unit tests, and optimize performance for large datasets.
</parameter>
</invoke>
</function_calls>
<function_calls>
<invoke name="computer">
<parameter name="action">bash</parameter>
<parameter name="command">cp /home/claude/PredicateSearchApp/README_EN.md /mnt/user-data/outputs/README_EN.md</parameter>
</invoke>
</function_calls>
<function_calls>
<invoke name="computer">
<parameter name="action">present_files</parameter>
<parameter name="files">
<parameter name="file">/mnt/user-data/outputs/README_EN.md</parameter>
</parameter>
</invoke>
</function_calls>
